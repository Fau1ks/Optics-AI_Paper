<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…‰å­¦+AIæœ€æ–°æ–‡çŒ®æ¨é€</title>
    <style>
        /* =================å…¨å±€æ ·å¼================= */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: #f6f8fa; color: #24292e; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; text-align: center; }
        
        /* æ ‡é¢˜æ ·å¼ (æµå…‰ç‰¹æ•ˆ) */
        h1 {
            font-size: 2.2rem; 
            margin-bottom: 30px;
            background: linear-gradient(to right, #0366d6, #d939cd, #9d00ff, #0366d6);
            background-size: 200% auto; 
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent; 
            animation: shine 4s linear infinite;
            cursor: pointer; /* â˜…â˜…â˜… ä¿®æ”¹ï¼šå¢åŠ æ‰‹å‹é¼ æ ‡ï¼Œæç¤ºå¯ç‚¹å‡» */
            user-select: none; /* é˜²æ­¢è¿ç‚¹æ—¶é€‰ä¸­æ–‡å­— */
        }
        @keyframes shine {
            to { background-position: -200% center; }
        }

        .social-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; margin-bottom: 40px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .social-item { display: flex; flex-direction: column; align-items: center; width: 280px; line-height: 1.5; }
        .social-title { font-weight: bold; margin-bottom: 10px; font-size: 16px; }
        .qr-code { width: 150px; height: 150px; object-fit: cover; border-radius: 8px; border: 1px solid #e1e4e8; }
        
        /* ä¸‹è½½æŒ‰é’®æ ·å¼ */
        .download-btn { 
            background-color: #2ea44f; 
            color: white; 
            padding: 15px 40px; 
            font-size: 18px; 
            border-radius: 6px; 
            text-decoration: none; 
            transition: background-color 0.2s; 
            box-shadow: 0 4px 6px rgba(46, 164, 79, 0.2); 
            max-width: 90%; 
            word-break: break-all; 
        }
        .download-btn:hover { background-color: #2c974b; }
        .loading { background-color: #94d3a2; cursor: wait; }
        
        /* â˜…â˜…â˜… æ–°å¢ï¼šScholar ä¸“ç”¨ä¸‹è½½æŒ‰é’®æ ·å¼ (ç´«è‰²ç³») â˜…â˜…â˜… */
        .scholar-download-btn {
            background-color: #8a2be2;
            color: white;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 6px;
            text-decoration: none;
            transition: background-color 0.2s;
            box-shadow: 0 4px 6px rgba(138, 43, 226, 0.2);
            max-width: 90%;
            word-break: break-all;
            display: inline-block;
            margin-top: 10px;
        }
        .scholar-download-btn:hover { background-color: #7a1cd1; }

        .update-time { margin-top: 15px; font-size: 14px; color: #0366d6; font-weight: 500; }
        .tips { margin-top: 5px; font-size: 12px; color: #586069; }
        
        /* æç¤ºæ¡†æ ·å¼ */
        .tips-container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 800px; width: 90%; margin-top: 50px; text-align: left; }
        .tips-container h2 { color: #333; font-size: 22px; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 20px; text-align: center; }
        .tip-item { margin-bottom: 30px; }
        .tip-title { font-weight: bold; font-size: 16px; color: #0366d6; margin-bottom: 10px; display: block; }
        .tip-text { color: #555; font-size: 15px; line-height: 1.6; margin-bottom: 15px; }
        .img-row { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; }
        .tip-img { max-width: 100%; height: auto; border-radius: 6px; border: 1px solid #e1e4e8; box-shadow: 0 2px 4px rgba(0,0,0,0.05); display: block; margin: 0 auto; }
        .img-row .tip-img { width: calc(50% - 10px); min-width: 280px; }
        @media (max-width: 600px) { h1 { font-size: 22px; } }

        /* é˜…è¯»åŒºæ ·å¼ */
        .reading-container { width: 100%; max-width: 800px; text-align: left; margin-top: 40px; margin-bottom: 20px; }
        .reading-title { text-align: center; color: #333; font-size: 22px; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        /* æœŸåˆŠå¤§åˆ†ç»„æ ·å¼ */
        .journal-group { 
            margin-bottom: 8px; 
            background: white; 
            border-radius: 8px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
            overflow: hidden; 
            border-left: 5px solid #0366d6; 
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-left 0.3s ease;
        }

        .journal-group:hover {
            transform: translateY(-2px); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.15); 
            border-left: 5px solid rgb(233, 163, 117); 
        }

        /* â˜…â˜…â˜… æ–°å¢ï¼šScholar åˆ†ç»„çš„ç‰¹æ®Šæ ·å¼ â˜…â˜…â˜… */
        .journal-group.scholar-group {
            border-left: 5px solid #8a2be2; /* ç´«è‰²è¾¹æ¡† */
        }
        .journal-group.scholar-group:hover {
            border-left: 5px solid #d939cd; /* æ‚¬æµ®å˜äº®ç´« */
        }
        
        /* æœŸåˆŠæŒ‰é’®å¸ƒå±€ */
        .journal-btn { 
            width: 100%; 
            text-align: left; 
            padding: 15px 20px; 
            background: white; 
            border: none; 
            cursor: pointer; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            font-size: 1.1rem; 
            font-weight: bold; 
            color: #24292e; 
            transition: 0.2s; 
            outline: none; 
        }
        .journal-btn:hover { background-color: #f1f8ff; }
        
        /* æ‰‹æœºç«¯é˜²æŒ¤å‹ */
        .journal-meta {
            display: flex;
            align-items: center;
            flex-shrink: 0;        
            white-space: nowrap; 
            margin-left: 10px;
        }

        .count-badge { background: #0366d6; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; margin-right: 10px; }
        /* Scholar çš„è®¡æ•°å¾½ç« é¢œè‰² */
        .scholar-group .count-badge { background: #8a2be2; }

        .arrow { transition: transform 0.3s; font-size: 0.8rem; color: #aaa; }
        .journal-btn.active .arrow { transform: rotate(180deg); }
        
        .article-list { display: none; border-top: 1px solid #eee; }
        
        /* æ–‡ç« æ ‡é¢˜æŒ‰é’®æ ·å¼ */
        .article-btn { 
            width: 100%; 
            text-align: left; 
            padding: 12px 25px; 
            background: #fff; 
            border: none; 
            cursor: pointer; 
            font-size: 1rem; 
            color: #444; 
            line-height: 1.5; 
            border-bottom: 1px solid #f1f1f1; 
            transition: background-color 0.2s, padding-left 0.2s, color 0.2s;
        }
        
        .article-btn:hover { 
            color: #0366d6; 
            background: #f8faff;
            padding-left: 28px; 
        }
        
        .article-btn.active { color: #0366d6; font-weight: bold; background: #fafafa; }
        
        /* è¯¦æƒ…åŒºåŸŸæ ·å¼ */
        .article-detail { 
            display: none; 
            padding: 15px 25px; 
            background-color: #fcfcfc; 
            border-bottom: 1px solid #eee; 
            transition: padding-left 0.2s ease, background-color 0.2s ease;
        }
        
        .article-detail:hover {
            padding-left: 28px; 
            background-color: #fff;
        }
        
        .title-box-en { color: #555; margin-bottom: 10px; font-size: 0.95rem; font-family: sans-serif; font-weight: bold; line-height: 1.4; }
        .link-box { display: block; background: #e6f6ff; color: #0366d6; padding: 10px; border-radius: 4px; text-decoration: none; font-size: 0.9rem; word-break: break-all; border: 1px solid #bfe3ff; text-align: center; font-weight: 500; }
        .link-box:hover { background: #cceeff; }
        
        /* æœç´¢æ¡†æ ·å¼ */
        .search-container { width: 100%; max-width: 800px; margin: 20px auto 10px; }
        #searchInput { 
            width: 100%; 
            padding: 12px 20px; 
            border: 1px solid #e1e4e8; 
            border-radius: 25px; 
            font-size: 16px; 
            outline: none; 
            transition: all 0.3s; 
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            box-sizing: border-box; 
        }
        #searchInput:focus { 
            border-color: #0366d6; 
            box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.3); 
        }
        .no-result { color: #666; margin-top: 20px; font-size: 14px; }

        /* æ‚¬æµ®æŒ‰é’®å®¹å™¨ */
        .float-btn-container {
            position: fixed;
            bottom: 100px; 
            left: 50%;
            margin-left: 420px; 
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 1000;
        }

        /* æŒ‰é’®æœ¬ä½“æ ·å¼ */
        .float-btn {
            background-color: #0366d6;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 4px 12px rgba(3, 102, 214, 0.4);
            display: none; 
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            border: none;
            outline: none;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap; 
        }
        .float-btn:hover {
            background-color: #024ea2;
            transform: scale(1.05);
        }
        .float-btn svg {
            width: 18px;
            height: 18px;
            fill: white;
            margin-right: 8px; 
        }

        /* å±å¹•è¾ƒçª„æ—¶çš„é€‚é… */
        @media (max-width: 1100px) {
            .float-btn-container {
                left: auto;
                right: 20px;
                bottom: 30px;
                margin-left: 0;
                align-items: flex-end; 
            }
        }

        /* å·¦å³åˆ‡æ¢å¼€å…³æ ·å¼ */
        .lang-switch-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            border: 1px solid #0366d6;
            border-radius: 20px;
            overflow: hidden;
            z-index: 1001;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .lang-option {
            background: white;
            color: #0366d6;
            border: none;
            width: 75px; 
            padding: 6px 0;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            outline: none;
            transition: all 0.2s;
        }

        .lang-option.active {
            background: #0366d6;
            color: white;
        }

        .lang-option:hover:not(.active) {
            background-color: #f0f6fc;
        }

        @media (max-width: 600px) {
            .lang-switch-container {
                top: 10px;
                right: 10px;
            }
            .lang-option {
                font-size: 12px;
                width: 60px;
                padding: 4px 0;
            }
        }
    </style>
</head>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<body>

    <div class="lang-switch-container">
        <button id="btn-zh" class="lang-option active" onclick="setLanguage('zh')">ä¸­æ–‡</button>
        <button id="btn-en" class="lang-option" onclick="setLanguage('en')">English</button>
    </div>

    <h1 id="pageTitle" onclick="triggerSecret()">å…‰å­¦+AI æœ€æ–°æ–‡çŒ®æ¨é€</h1>

    <p id="pageIntro" style="color: #666; font-size: 15px; margin-top: -15px; margin-bottom: 25px; line-height: 1.6;">
        å¦‚éœ€å¾€æœŸæ–‡çŒ®ï¼Œå¯å…³æ³¨ä»¥ä¸‹è´¦å·<br>
        ä¹Ÿæ¬¢è¿å­¦æœ¯äº¤æµä»¥åŠæå‡ºæ‚¨çš„å»ºè®®
    </p>

    <div class="social-container">
        <div class="social-item">
            <div id="xhsTitle" class="social-title">å°çº¢ä¹¦ï¼šè®¡ç®—å…‰å­¦æœ€æ–°æ–‡çŒ®æ¨é€</div>
            <img src="xhs.jpg" alt="å°çº¢ä¹¦äºŒç»´ç " class="qr-code">
        </div>
        <div class="social-item">
            <div id="wxTitle" class="social-title">å…¬ä¼—å·ï¼šè®¡ç®—å…‰å­¦æœ€æ–°æ–‡çŒ®æ¨é€</div>
            <img src="wx.jpg" alt="å…¬ä¼—å·äºŒç»´ç " class="qr-code">
        </div>
    </div>

    <a id="downloadBtn" href="#" class="download-btn loading">æ­£åœ¨æŸ¥æ‰¾æœ€æ–°æ¨é€...</a>
    <div id="fileTime" class="update-time">æ­£åœ¨è·å–æ›´æ–°æ—¶é—´...</div>
    <div id="downloadTip" class="tips">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ç›´æ¥ä¸‹è½½æœ€æ–° Word æ–‡æ¡£</div>
    
    <div class="search-container" id="searchArea" style="display:none;">
        <input type="text" id="searchInput" placeholder="ğŸ” æœç´¢æ ‡é¢˜ã€ä½œè€…æˆ–æ‘˜è¦ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰..." oninput="searchPapers()">
    </div>

    <div class="reading-container" id="readingArea" style="display:none;">
        <div id="readingTitle" class="reading-title">ğŸ“– åœ¨çº¿é€Ÿè§ˆ</div>
        <div id="accordionContent"></div>
    </div>

    <div class="reading-container" id="scholarArea" style="display:none; margin-top: 50px; border-top: 2px dashed #ccc; padding-top: 30px;">
        <div id="scholarTitle" class="reading-title" style="color: #8a2be2;">ğŸ“ Google Scholar Monitor</div>
        <div style="text-align: center; margin-bottom: 20px;">
            <a id="scholarDownloadBtn" href="#" class="scholar-download-btn">ğŸ” Searching Scholar Summary...</a>
            <div id="scholarUpdateStatus" class="tips">Secret Mode Activated</div>
        </div>
        <div id="scholarContent"></div>
    </div>

    <div class="float-btn-container">
        <button id="collapseArticlesBtn" class="float-btn" onclick="collapseAllArticles()">
            <svg viewBox="0 0 24 24">
                <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/> 
            </svg>
            <span id="btnCollapseArticles">æ”¶èµ·æ–‡çŒ®</span>
        </button>

        <button id="collapseJournalsBtn" class="float-btn" onclick="collapseAllJournals()">
            <svg viewBox="0 0 24 24">
                <path d="M6 17.59L7.41 19 12 14.42 16.59 19 18 17.59l-6-6z"/>
                <path d="M6 11l1.41 1.41L12 7.83l4.59 4.58L18 11l-6-6z"/>
            </svg>
            <span id="btnCollapseJournals">æ”¶èµ·æœŸåˆŠ</span>
        </button>
    </div>

    <div style="width: 100%; max-width: 800px; margin: 30px auto; text-align: center; font-size: 13px; color: #888;">
        <span id="busuanzi_container_site_pv" style="display:none">
            ğŸ‘€ æœ¬ç«™æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv" style="font-weight:bold; color:#0366d6;"></span> æ¬¡
        </span>
        <span style="margin: 0 10px; color: #ddd;">|</span>
        <span id="busuanzi_container_site_uv" style="display:none">
            ğŸ‘¤ è®¿å®¢æ•° <span id="busuanzi_value_site_uv" style="font-weight:bold; color:#0366d6;"></span> äºº
        </span>
    </div>      
    
    <div class="tips-container">
        <h2 id="tipsTitle">ğŸ’¡ ä½¿ç”¨æ³¨æ„äº‹é¡¹</h2>
        <div class="tip-item">
            <span id="navTipTitle" class="tip-title">æé«˜é˜…è¯»æ•ˆç‡ï¼šå»ºè®®å¼€å¯å¯¼èˆªçª—æ ¼</span>
            <p id="navTipText" class="tip-text">ä¸ºäº†æ›´æ–¹ä¾¿åœ°æµè§ˆé•¿æ–‡æ¡£ï¼Œå»ºè®®åœ¨ Word é¡¶éƒ¨èœå•æ é€‰æ‹© <strong>â€œè§†å›¾â€</strong>ï¼Œå¹¶å‹¾é€‰ <strong>â€œå¯¼èˆªçª—æ ¼â€</strong>ã€‚</p>
            <img src="remind1.jpg" alt="å¼€å¯å¯¼èˆªçª—æ ¼æ¼”ç¤º" class="tip-img">
        </div>
    </div>

    <script>
        const GITHUB_USERNAME = 'Fau1ks'; 
        const REPO_NAME = 'Optics-AI_Paper';        
        const contentApiUrl = `https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/contents/`;
        
        // ================= è¯­è¨€é…ç½® =================
        let currentLang = 'zh'; // é»˜è®¤ä¸­æ–‡
        let globalLatestDateCode = ''; 

        const langData = {
            'zh': {
                pageTitle: 'å…‰å­¦+AI æœ€æ–°æ–‡çŒ®æ¨é€',
                pageIntro: 'å¦‚éœ€å¾€æœŸæ–‡çŒ®ï¼Œå¯å…³æ³¨ä»¥ä¸‹è´¦å·<br>ä¹Ÿæ¬¢è¿å­¦æœ¯äº¤æµä»¥åŠæå‡ºæ‚¨çš„å»ºè®®',
                xhsTitle: 'å°çº¢ä¹¦ï¼šè®¡ç®—å…‰å­¦æœ€æ–°æ–‡çŒ®æ¨é€',
                wxTitle: 'å…¬ä¼—å·ï¼šè®¡ç®—å…‰å­¦æœ€æ–°æ–‡çŒ®æ¨é€',
                downloadLoading: 'æ­£åœ¨æŸ¥æ‰¾æœ€æ–°æ¨é€...',
                downloadPrefix: 'ğŸ“„ ä¸‹è½½æœ€æ–°æ¨é€ï¼š',
                downloadFail: 'è·å–åˆ—è¡¨å¤±è´¥',
                noData: 'ä»Šæ—¥æš‚æ— æ¨é€',
                timePrefix: 'æœ€åæ›´æ–°æ—¶é—´ï¼š',
                downloadTip: 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ç›´æ¥ä¸‹è½½æœ€æ–° Word æ–‡æ¡£',
                searchPlaceholder: 'ğŸ” æœç´¢æ ‡é¢˜ã€ä½œè€…æˆ–æ‘˜è¦ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰...',
                readingTitle: 'ğŸ“– åœ¨çº¿é€Ÿè§ˆ',
                btnCollapseArticles: 'æ”¶èµ·æ–‡çŒ®',
                btnCollapseJournals: 'æ”¶èµ·æœŸåˆŠ',
                tipsTitle: 'ğŸ’¡ ä½¿ç”¨æ³¨æ„äº‹é¡¹',
                navTipTitle: 'æé«˜é˜…è¯»æ•ˆç‡ï¼šå»ºè®®å¼€å¯å¯¼èˆªçª—æ ¼',
                navTipText: 'ä¸ºäº†æ›´æ–¹ä¾¿åœ°æµè§ˆé•¿æ–‡æ¡£ï¼Œå»ºè®®åœ¨ Word é¡¶éƒ¨èœå•æ é€‰æ‹© <strong>â€œè§†å›¾â€</strong>ï¼Œå¹¶å‹¾é€‰ <strong>â€œå¯¼èˆªçª—æ ¼â€</strong>ã€‚',
                noResult: 'ğŸ˜• æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ–‡çŒ®ï¼Œæ¢ä¸ªå…³é”®è¯è¯•è¯•ï¼Ÿ',
                // åŠ¨æ€ç”Ÿæˆçš„æ ‡ç­¾
                detailLabelTag: 'English', 
                authorLabel: 'ğŸ‘¤ Authors:',
                // â˜…â˜…â˜… Scholar æ–°å¢ç¿»è¯‘
                scholarTitle: 'ğŸ“ Google Scholar å®æ—¶ç›‘æ§',
                scholarBtnPrefix: 'ğŸ“„ ä¸‹è½½ Scholar æ±‡æ€»ï¼š'
            },
            'en': {
                pageTitle: 'Latest Optics + AI Paper Feed',
                pageIntro: 'Follow our accounts for past archives.<br>Academic exchanges and suggestions are welcome.',
                xhsTitle: 'Xiaohongshu',
                wxTitle: 'WeChat',
                downloadLoading: 'Searching for latest feed...',
                downloadPrefix: 'ğŸ“„ Download Latest Feed: ',
                downloadFail: 'Failed to fetch list',
                noData: 'No updates today',
                timePrefix: 'Last Updated: ',
                downloadTip: 'Click above to download the latest Word document',
                searchPlaceholder: 'ğŸ” Search title, author or abstract...',
                readingTitle: 'ğŸ“– Quick Preview',
                btnCollapseArticles: 'Collapse Articles',
                btnCollapseJournals: 'Collapse Journals',
                tipsTitle: 'ğŸ’¡ Usage Tips',
                navTipTitle: 'Efficiency Tip: Enable Navigation Pane',
                navTipText: 'For better navigation, go to <strong>"View"</strong> tab in Word and check <strong>"Navigation Pane"</strong>.',
                noResult: 'ğŸ˜• No papers found. Try a different keyword?',
                // åŠ¨æ€ç”Ÿæˆçš„æ ‡ç­¾
                detailLabelTag: 'ä¸­æ–‡æ ‡é¢˜',
                authorLabel: 'ğŸ‘¤ Authors:',
                // â˜…â˜…â˜… Scholar æ–°å¢ç¿»è¯‘
                scholarTitle: 'ğŸ“ Google Scholar Monitor',
                scholarBtnPrefix: 'ğŸ“„ Download Scholar Summary: '
            }
        };

        const btn = document.getElementById('downloadBtn');
        const timeDiv = document.getElementById('fileTime');
        const articleBtn = document.getElementById('collapseArticlesBtn');
        const journalBtn = document.getElementById('collapseJournalsBtn');

        function escapeHtml(text) {
            if (!text) return "";
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // ================= è¯­è¨€åˆ‡æ¢é€»è¾‘ =================
        function setLanguage(lang) {
            if (currentLang === lang) return; 
            currentLang = lang;
            
            // æ›´æ–°æŒ‰é’®é«˜äº®çŠ¶æ€
            const btnZh = document.getElementById('btn-zh');
            const btnEn = document.getElementById('btn-en');
            
            if (lang === 'zh') {
                btnZh.classList.add('active');
                btnEn.classList.remove('active');
            } else {
                btnZh.classList.remove('active');
                btnEn.classList.add('active');
            }

            updateStaticUI();
            
            // é‡æ–°æ¸²æŸ“åˆ—è¡¨
            if (allPapersData.length > 0) {
                const searchInput = document.getElementById('searchInput');
                if (searchInput && searchInput.value.trim() !== "") {
                    searchPapers();
                } else {
                    renderPapers(allPapersData, false); 
                }
            }

            // â˜…â˜…â˜… å¦‚æœ Scholar åŒºåŸŸæ˜¯å¯è§çš„ï¼Œé‡æ–°æ¸²æŸ“å®ƒä»¥æ›´æ–°è¯­è¨€
            if (document.getElementById('scholarArea').style.display === 'block') {
                updateScholarUI(); // æ›´æ–°æ ‡é¢˜
                if(window.scholarDataCache) {
                    renderScholarList(window.scholarDataCache); // é‡æ–°æ¸²æŸ“åˆ—è¡¨ï¼ˆå¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼‰
                }
            }
        }

        function updateStaticUI() {
            const t = langData[currentLang];
            
            document.getElementById('pageTitle').innerText = t.pageTitle;
            document.getElementById('pageIntro').innerHTML = t.pageIntro;
            document.getElementById('xhsTitle').innerText = t.xhsTitle;
            document.getElementById('wxTitle').innerText = t.wxTitle;
            document.getElementById('downloadTip').innerText = t.downloadTip;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            document.getElementById('readingTitle').innerText = t.readingTitle;
            document.getElementById('btnCollapseArticles').innerText = t.btnCollapseArticles;
            document.getElementById('btnCollapseJournals').innerText = t.btnCollapseJournals;
            document.getElementById('tipsTitle').innerText = t.tipsTitle;
            document.getElementById('navTipTitle').innerText = t.navTipTitle;
            document.getElementById('navTipText').innerHTML = t.navTipText;

            if (globalLatestDateCode) {
                btn.innerText = t.downloadPrefix + globalLatestDateCode;
            } else if (btn.classList.contains('loading')) {
                btn.innerText = t.downloadLoading;
            } else if (btn.innerText.includes('æš‚æ— ') || btn.innerText.includes('No updates')) {
                btn.innerText = t.noData;
            }
            
            if (timeDiv.dataset.timeStr) {
                 timeDiv.innerText = t.timePrefix + timeDiv.dataset.timeStr;
            }
        }

        // ======================================================================
        // ä¸»é€»è¾‘ï¼šè¯»å–æœ€æ–° JSON
        // ======================================================================
        updateStaticUI(); 

        let allPapersData = []; 

        const timestamp = new Date().getTime();
        
        fetch('latest_data.json?t=' + timestamp)
            .then(response => response.json())
            .then(data => {
                let papers = [];
                let metaTime = null;
                let metaFile = null;

                if (Array.isArray(data)) {
                    console.log("Detected legacy JSON array format. Falling back to API.");
                    papers = data;
                    fallbackToGithubApi();
                } else {
                    console.log("Detected new JSON object format.");
                    papers = data.data || [];
                    
                    if (data.update_time) {
                        metaTime = data.update_time;
                        timeDiv.dataset.timeStr = metaTime + " (åŒ—äº¬æ—¶é—´)";
                        timeDiv.innerText = langData[currentLang].timePrefix + timeDiv.dataset.timeStr;
                    }

                    if (data.word_filename) {
                        metaFile = data.word_filename;
                        const t = langData[currentLang];
                        globalLatestDateCode = metaFile.replace('Optical_Papers_', '').replace('.docx', '');
                        
                        btn.innerText = t.downloadPrefix + globalLatestDateCode;
                        btn.href = `https://github.com/${GITHUB_USERNAME}/${REPO_NAME}/raw/main/${metaFile}`;
                        btn.classList.remove('loading');
                        btn.setAttribute("target", "_blank");
                    } else {
                        fallbackToGithubApi();
                    }
                }

                if (!papers || papers.length === 0) {
                     const t = langData[currentLang];
                     btn.innerText = t.noData;
                     btn.style.backgroundColor = "#666"; 
                     timeDiv.style.display = 'none';
                     return;
                }

                allPapersData = papers;
                document.getElementById('readingArea').style.display = 'block';
                document.getElementById('searchArea').style.display = 'block'; 
                renderPapers(allPapersData, false);
            })
            .catch(err => {
                console.error("Main data fetch failed:", err);
                const t = langData[currentLang];
                btn.innerText = t.downloadFail;
                btn.style.backgroundColor = "#d73a49";
                fallbackToGithubApi();
            });

        function fallbackToGithubApi() {
            if (!btn.classList.contains('loading')) return;

            fetch(contentApiUrl)
                .then(response => response.json())
                .then(data => {
                    const wordFiles = data.filter(item => item.name.startsWith('Optical_Papers_') && item.name.endsWith('.docx'));
                    const t = langData[currentLang];

                    if (wordFiles.length === 0) {
                        btn.innerText = t.noData;
                        btn.style.backgroundColor = "#666"; 
                        timeDiv.style.display = 'none';
                        return;
                    }
                    wordFiles.sort((a, b) => a.name.localeCompare(b.name));
                    const latestFile = wordFiles[wordFiles.length - 1];
                    
                    globalLatestDateCode = latestFile.name.replace('Optical_Papers_', '').replace('.docx', '');
                    
                    btn.innerText = t.downloadPrefix + globalLatestDateCode; 
                    btn.href = latestFile.download_url; 
                    btn.classList.remove('loading'); 
                    btn.setAttribute("target", "_blank");

                    const commitApiUrl = `https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/commits?path=${latestFile.name}&page=1&per_page=1`;
                    fetch(commitApiUrl)
                        .then(res => res.json())
                        .then(commits => {
                            if (commits && commits.length > 0) {
                                const dateObj = new Date(commits[0].commit.committer.date);
                                const timeStr = dateObj.toLocaleString('zh-CN', { hour12: false });
                                timeDiv.dataset.timeStr = timeStr;
                                timeDiv.innerText = langData[currentLang].timePrefix + timeStr;
                            }
                        }).catch(() => timeDiv.innerText = "");
                })
                .catch(error => {
                    console.error('API Error:', error);
                });
        }

        // ================= æ¸²æŸ“ä¸äº¤äº’é€»è¾‘ (ä¿æŒä¸å˜) =================
        function renderPapers(papersToRender, expandAll = false) {
            const container = document.getElementById('accordionContent');
            const t = langData[currentLang];
            
            if (!papersToRender || papersToRender.length === 0) {
                container.innerHTML = `<div class="no-result" style="text-align:center; color:#666; padding:20px;">${t.noResult}</div>`;
                return;
            }

            const papersByJournal = {};
            papersToRender.forEach(paper => {
                const j = escapeHtml(paper.journal || 'Unknown Journal');
                if (!papersByJournal[j]) papersByJournal[j] = [];
                papersByJournal[j].push(paper);
            });

            const activeClass = expandAll ? 'active' : '';
            const arrowStyle = expandAll ? 'transform: rotate(180deg);' : '';
            const listStyle = expandAll ? 'display: block;' : 'display: none;';

            let html = '';
            for (const [journal, papers] of Object.entries(papersByJournal)) {
                html += `
                <div class="journal-group">
                    <button class="journal-btn ${activeClass}" onclick="toggleAccordion(this)">
                        <span>${journal}</span>
                        <div class="journal-meta">
                            <span class="count-badge">${papers.length}</span>
                            <span class="arrow" style="${arrowStyle}">â–¼</span>
                        </div>
                    </button>
                    <div class="article-list" style="${listStyle}">
                `;
                
                papers.forEach(paper => {
                    let mainTitle, subTitle;
                    
                    if (currentLang === 'zh') {
                        mainTitle = escapeHtml(paper.title_cn || paper.title);
                        subTitle = escapeHtml(paper.title);
                    } else {
                        mainTitle = escapeHtml(paper.title);
                        subTitle = escapeHtml(paper.title_cn || "Chinese translation not available");
                    }
                    
                    const author = escapeHtml(paper.author || 'Unknown Author');
                    const idLink = paper.id || paper.link || '#';
                    
                    html += `
                        <div class="article-item">
                            <button class="article-btn" onclick="toggleAccordion(this)">${mainTitle}</button>
                            <div class="article-detail">
                                <div class="title-box-en">
                                    <span style="background:#eee;padding:2px 6px;border-radius:4px;font-size:0.75em;color:#666;margin-right:5px;">
                                        ${t.detailLabelTag}
                                    </span>
                                    ${subTitle}
                                </div>
                                
                                <div style="font-size:13px; color:#555; margin:10px 0; line-height:1.4;">
                                    <strong>${t.authorLabel}</strong> ${author}
                                </div>
                                
                                <a href="${idLink}" target="_blank" class="link-box">ğŸ”— ${idLink}</a>
                            </div>
                        </div>
                    `;
                });
                html += `</div></div>`;
            }
            container.innerHTML = html;
            
            checkButtonsVisibility();
        }

        // 4. æœç´¢åŠŸèƒ½
        function searchPapers() {
            const input = document.getElementById('searchInput');
            if(!input) return;
            const query = input.value.toLowerCase().trim();

            if (!query) {
                renderPapers(allPapersData, false);
                return;
            }

            const filteredData = allPapersData.filter(paper => {
                const titleEn = (paper.title || '').toLowerCase();
                const titleCn = (paper.title_cn || '').toLowerCase();
                const author = (paper.author || '').toLowerCase();
                const abstractEn = (paper.summary || '').toLowerCase();
                const abstractCn = (paper.abstract_cn || '').toLowerCase();

                return titleEn.includes(query) || 
                       titleCn.includes(query) || 
                       author.includes(query) || 
                       abstractEn.includes(query) || 
                       abstractCn.includes(query);
            });

            renderPapers(filteredData, true);
        }

        // 5. äº¤äº’åŠ¨ç”»ä¸é€»è¾‘
        function toggleAccordion(element) {
            if (!element) return;
            
            if (element.classList.contains('article-btn')) {
                element.classList.toggle("active");
                const content = element.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            } 
            else {
                element.classList.toggle("active");
                const content = element.nextElementSibling;
                const arrow = element.querySelector('.arrow');
                if (content.style.display === "block") {
                    content.style.display = "none";
                    if(arrow) arrow.style.transform = "rotate(0deg)";
                } else {
                    content.style.display = "block";
                    if(arrow) arrow.style.transform = "rotate(180deg)";
                }
            }
            checkButtonsVisibility();
        }

        function checkButtonsVisibility() {
            const anyArticleOpen = document.querySelectorAll('.article-detail[style*="block"]').length > 0;
            if (anyArticleOpen) {
                articleBtn.style.display = 'flex';
            } else {
                articleBtn.style.display = 'none';
            }

            const anyJournalOpen = document.querySelectorAll('.journal-btn.active').length > 0;
            if (anyJournalOpen) {
                journalBtn.style.display = 'flex';
            } else {
                journalBtn.style.display = 'none';
            }
        }

        function collapseAllArticles() {
            const openDetails = document.querySelectorAll('.article-detail[style*="block"]');
            openDetails.forEach(detail => detail.style.display = 'none');
            
            const activeBtns = document.querySelectorAll('.article-btn.active');
            activeBtns.forEach(btn => btn.classList.remove('active'));

            checkButtonsVisibility();
        }

        function collapseAllJournals() {
            collapseAllArticles();
            const openLists = document.querySelectorAll('.article-list[style*="block"]');
            openLists.forEach(list => list.style.display = 'none');

            const activeJournals = document.querySelectorAll('.journal-btn.active');
            activeJournals.forEach(btn => {
                btn.classList.remove('active');
                const arrow = btn.querySelector('.arrow');
                if(arrow) arrow.style.transform = 'rotate(0deg)';
            });

            checkButtonsVisibility();
        }

        // ======================================================================
        // â˜…â˜…â˜… æ–°å¢ï¼šç§˜å¯†å…¥å£ä¸ Scholar å¤„ç†é€»è¾‘
        // ======================================================================
        
        let clickCount = 0;
        let clickTimer = null;
        let isSecretActive = false;

        function triggerSecret() {
            if (isSecretActive) return; // å·²ç»æ¿€æ´»è¿‡äº†

            clickCount++;
            
            // å¦‚æœ 2ç§’å†…æ²¡æœ‰ç»§ç»­ç‚¹å‡»ï¼Œé‡ç½®è®¡æ•°å™¨
            clearTimeout(clickTimer);
            clickTimer = setTimeout(() => {
                clickCount = 0;
            }, 2000);

            if (clickCount >= 5) {
                activateScholarMode();
            }
        }

        function activateScholarMode() {
            isSecretActive = true;
            clickCount = 0;
            const scholarArea = document.getElementById('scholarArea');
            scholarArea.style.display = 'block';
            
            // ç®€å•æç¤º
            alert("ğŸ”“ Secret Mode: Google Scholar Monitor Activated!");
            
            // 1. è·å– Scholar JSON æ•°æ®
            fetchScholarData();

            // 2. è·å–æœ€æ–° Scholar Word æ–‡æ¡£
            fetchScholarSummaryDoc();
            
            // 3. æ»šåŠ¨åˆ°åº•éƒ¨
            scholarArea.scrollIntoView({behavior: "smooth"});
        }

        function updateScholarUI() {
             const t = langData[currentLang];
             document.getElementById('scholarTitle').innerText = t.scholarTitle;
             // å¦‚æœæŒ‰é’®å·²ç»æœ‰æ–‡ä»¶åï¼Œæ›´æ–°å‰ç¼€
             const sBtn = document.getElementById('scholarDownloadBtn');
             if(sBtn.dataset.filename) {
                 sBtn.innerText = t.scholarBtnPrefix + sBtn.dataset.filename;
             }
        }

        function fetchScholarData() {
            const ts = new Date().getTime();
            fetch('Scholar_Data_latest.json?t=' + ts)
                .then(res => res.json())
                .then(data => {
                    window.scholarDataCache = data; // ç¼“å­˜ä»¥ä¾¿åˆ‡æ¢è¯­è¨€æ—¶ä½¿ç”¨
                    renderScholarList(data);
                })
                .catch(err => {
                    console.error("Scholar Data Error", err);
                    document.getElementById('scholarContent').innerHTML = "<div class='no-result'>Load Failed.</div>";
                });
        }

        function renderScholarList(data) {
            const container = document.getElementById('scholarContent');
            const t = langData[currentLang];

            if (!data || data.length === 0) {
                container.innerHTML = "<div class='no-result'>No Scholar Data.</div>";
                return;
            }

            // Scholar æ•°æ®ä¸åˆ†æœŸåˆŠï¼Œç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªå¤§ç»„é‡Œ
            // æ„é€ ä¸€ä¸ª fake group
            const groupTitle = "Google Scholar Daily Push";
            const papers = data;

            let html = `
                <div class="journal-group scholar-group">
                    <button class="journal-btn active" onclick="toggleAccordion(this)">
                        <span>${groupTitle}</span>
                        <div class="journal-meta">
                            <span class="count-badge">${papers.length}</span>
                            <span class="arrow" style="transform: rotate(180deg);">â–¼</span>
                        </div>
                    </button>
                    <div class="article-list" style="display: block;">
            `;

            papers.forEach(paper => {
                let mainTitle, subTitle;
                if (currentLang === 'zh') {
                    mainTitle = escapeHtml(paper.title_cn || paper.title);
                    subTitle = escapeHtml(paper.title);
                } else {
                    mainTitle = escapeHtml(paper.title);
                    subTitle = escapeHtml(paper.title_cn || "Translation N/A");
                }
                const link = paper.link || '#';

                html += `
                    <div class="article-item">
                        <button class="article-btn" onclick="toggleAccordion(this)">${mainTitle}</button>
                        <div class="article-detail">
                            <div class="title-box-en">
                                <span style="background:#eee;padding:2px 6px;border-radius:4px;font-size:0.75em;color:#666;margin-right:5px;">
                                    ${t.detailLabelTag}
                                </span>
                                ${subTitle}
                            </div>
                            <div style="margin-top:10px;"></div>
                            <a href="${link}" target="_blank" class="link-box">ğŸ”— Link</a>
                        </div>
                    </div>
                `;
            });

            html += `</div></div>`;
            container.innerHTML = html;
        }

        function fetchScholarSummaryDoc() {
            const sBtn = document.getElementById('scholarDownloadBtn');
            const t = langData[currentLang];

            fetch(contentApiUrl)
                .then(response => response.json())
                .then(data => {
                    // ç­›é€‰ Scholar_Summary_ å¼€å¤´çš„ docx
                    const scholarFiles = data.filter(item => item.name.startsWith('Scholar_Summary_') && item.name.endsWith('.docx'));
                    
                    if (scholarFiles.length === 0) {
                        sBtn.innerText = "No Summary Found";
                        sBtn.style.backgroundColor = "#666";
                        return;
                    }

                    // æ’åºæ‰¾åˆ°æœ€æ–°çš„
                    scholarFiles.sort((a, b) => a.name.localeCompare(b.name));
                    const latest = scholarFiles[scholarFiles.length - 1];
                    const dateCode = latest.name.replace('Scholar_Summary_', '').replace('.docx', '');

                    sBtn.dataset.filename = dateCode; // å­˜ä¸€ä¸‹ï¼Œæ–¹ä¾¿åˆ‡æ¢è¯­è¨€æ—¶è¯»å–
                    sBtn.innerText = t.scholarBtnPrefix + dateCode;
                    sBtn.href = latest.download_url; // ä½¿ç”¨ raw url
                    sBtn.setAttribute("target", "_blank");
                })
                .catch(err => {
                    console.error(err);
                    sBtn.innerText = "Summary Fetch Error";
                });
        }

    </script>
</body>
</html>
